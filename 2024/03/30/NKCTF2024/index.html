<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>2024NKCTF | w3nx1z1</title><meta name="author" content="w3nx1z1"><meta name="copyright" content="w3nx1z1"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="NKCTF2024Miscwebshell_pro(AES解密 webshell)追踪tcp流 在流9中发现一段长字符 解两次base64  是一个RSA加密脚本   直接chat跑一下 改个解密脚本 import base64 import libnum from Crypto.PublicKey import RSA  pubkey &#x3D; &quot;&quot;&quot;-----BEGIN">
<meta property="og:type" content="article">
<meta property="og:title" content="2024NKCTF">
<meta property="og:url" content="http://w3nx1z1.github.io/2024/03/30/NKCTF2024/index.html">
<meta property="og:site_name" content="w3nx1z1">
<meta property="og:description" content="NKCTF2024Miscwebshell_pro(AES解密 webshell)追踪tcp流 在流9中发现一段长字符 解两次base64  是一个RSA加密脚本   直接chat跑一下 改个解密脚本 import base64 import libnum from Crypto.PublicKey import RSA  pubkey &#x3D; &quot;&quot;&quot;-----BEGIN">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://w3nx1z1.github.io/img/mikey.png">
<meta property="article:published_time" content="2024-03-30T02:51:06.292Z">
<meta property="article:modified_time" content="2024-04-05T01:33:52.188Z">
<meta property="article:author" content="w3nx1z1">
<meta property="article:tag" content="misc">
<meta property="article:tag" content="web">
<meta property="article:tag" content="forensics">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://w3nx1z1.github.io/img/mikey.png"><link rel="shortcut icon" href="/img/%E8%87%AA%E7%94%B1%E4%B9%8B%E7%BF%BC.jpg"><link rel="canonical" href="http://w3nx1z1.github.io/2024/03/30/NKCTF2024/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '2024NKCTF',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-04-05 09:33:52'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="\themes\butterfly\source\css\custom.css"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="w3nx1z1" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/mikey.png" onerror="onerror=null;src='/img/404.jpg'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">46</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/baobao.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="w3nx1z1"><span class="site-name">w3nx1z1</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">2024NKCTF</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-03-30T02:51:06.292Z" title="发表于 2024-03-30 10:51:06">2024-03-30</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-04-05T01:33:52.188Z" title="更新于 2024-04-05 09:33:52">2024-04-05</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ctf/">ctf</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>15分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="2024NKCTF"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="NKCTF2024"><a href="#NKCTF2024" class="headerlink" title="NKCTF2024"></a>NKCTF2024</h1><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="webshell-pro-AES解密-webshell"><a href="#webshell-pro-AES解密-webshell" class="headerlink" title="webshell_pro(AES解密 webshell)"></a>webshell_pro(AES解密 webshell)</h3><p>追踪tcp流 在流9中发现一段长字符 解两次base64  是一个RSA加密脚本 </p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403231554213.png" alt="image-20240323155405146"></p>
<p>直接chat跑一下 改个解密脚本</p>
<pre><code class="python">import base64
import libnum
from Crypto.PublicKey import RSA

pubkey = &quot;&quot;&quot;-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCK/qv5P8ixWjoFI2rzF62tm6sDFnRsKsGhVSCuxQIxuehMWQLmv6TPxyTQPefIKufzfUFaca/YHkIVIC19ohmE5X738TtxGbOgiGef4bvd9sU6M42k8vMlCPJp1woDFDOFoBQpr4YzH4ZTR6Ps+HP8VEIJMG5uiLQOLxdKdxi41QIDAQAB
-----END PUBLIC KEY-----
&quot;&quot;&quot;

prikey = &quot;&quot;&quot;-----BEGIN PRIVATE KEY-----
MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBAIr+q/k/yLFaOgUjavMXra2bqwMWdGwqwaFVIK7FAjG56ExZAua/pM/HJNA958gq5/N9QVpxr9geQhUgLX2iGYTlfvfxO3EZs6CIZ5/hu932xTozjaTy8yUI8mnXCgMUM4WgFCmvhjMfhlNHo+z4c/xUQgkwbm6ItA4vF0p3GLjVAgMBAAECgYBDsqawT5DAUOHRft6oZ+//jsJMTrOFu41ztrKkbPAUqCesh+4R1WXAjY4wnvY1WDCBN5CNLLIo4RPuli2R81HZ4OpZuiHv81sNMccauhrJrioDdbxhxbM7/jQ6M9YajwdNisL5zClXCOs1/y01+9vDiMDk0kX8hiIYlpPKDwjqQQJBAL6Y0fuoJng57GGhdwvN2c656tLDPj9GRi0sfeeMqavRTMz6/qea1LdAuzDhRoS2Wb8ArhOkYns0GMazzc1q428CQQC6sM9OiVR4EV/ewGnBnF+0p3alcYr//Gp1wZ6fKIrFJQpbHTzf27AhKgOJ1qB6A7P/mQS6JvYDPsgrVkPLRnX7AkEAr/xpfyXfB4nsUqWFR3f2UiRmx98RfdlEePeo9YFzNTvX3zkuo9GZ8e8qKNMJiwbYzT0yft59NGeBLQ/eynqUrwJAE6Nxy0Mq/Y5mVVpMRa+babeMBY9SHeeBk22QsBFlt6NT2Y3Tz4CeoH547NEFBJDLKIICO0rJ6kF6cQScERASbQJAZy088sVY6DJtGRLPuysv3NiyfEvikmczCEkDPex4shvFLddwNUlmhzml5pscIie44mBOJ0uX37y+co3q6UoRQg==
-----END PRIVATE KEY-----
&quot;&quot;&quot;

pubkey = RSA.import_key(pubkey)
prikey = RSA.import_key(prikey)
n = pubkey.n

def dec_replace(base64_str: str):
    base64_str = base64_str.replace(&quot;e5Lg^FM5EQYe5!yF&amp;62%V$UG*B*RfQeM&quot;, &quot;/&quot;)
    base64_str = base64_str.replace(&quot;n6&amp;B8G6nE@2tt4UR6h3QBt*5&amp;C&amp;pVu8W&quot;, &quot;+&quot;)
    return base64_str.replace(&quot;JXWUDuLUgwRLKD9fD6&amp;VY2aFeE&amp;r@Ff2&quot;, &quot;=&quot;)

def decrypt(cipher_text):
    cipher_text = base64.b64decode(dec_replace(cipher_text))
    plain_text = b&quot;&quot;
    for i in range(0, len(cipher_text), 128):
        part = cipher_text[i:i+128]
        dec = libnum.n2s(pow(libnum.s2n(part), pubkey.e, n))
        plain_text += dec
    return plain_text

if __name__ == &#39;__main__&#39;:
    c = &quot;G1TUg4bIVOFYi8omV2SQrTa8fzYfboRNN7fV6FJn6&amp;B8G6nE@2tt4UR6h3QBt*5&amp;C&amp;pVu8Wbm3O74uCUbwMkvRCYae44TX1ZO8X4w2Nk1igaIZjSQIJ9MMHhD9cn6&amp;B8G6nE@2tt4UR6h3QBt*5&amp;C&amp;pVu8WSV5EzikNsyM5c1nlPS8uqw1P2pJuYLaLxloK0x5xhQHDqqAxkuKrBzPn0noQ2bDn6&amp;B8G6nE@2tt4UR6h3QBt*5&amp;C&amp;pVu8WlVnGwsfP7YP9PYJXWUDuLUgwRLKD9fD6&amp;VY2aFeE&amp;r@Ff2&quot;
    m = decrypt(c)
    print(m)
</code></pre>
<p>在流8找到一个password 先解base32再解base64</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403241959033.png" alt="image-20240324195921893"></p>
<pre><code>Password-based-encryption
</code></pre>
<p>再找到密文 在流10的shell内容中 使用上面的解密脚本进行解密</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403250800132.png" alt="image-20240325080056063"></p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403250801572.png" alt="image-20240325080129511"></p>
<p>得到密文的值为</p>
<pre><code>U2FsdGVkX1+SslS2BbHfe3c4/t/KxLaM6ZFlOdbtfMHnG8lepnhMnde40tNOYjSvoErLzy0csL7c5d4TlMntBQ==
</code></pre>
<p>直接用上面的密钥解AES</p>
<pre><code>flag&#123;d0e1183c-07c3-49ea-b048-addbe6cc1b20&#125;
</code></pre>
<h3 id="sign-in"><a href="#sign-in" class="headerlink" title="sign_in"></a>sign_in</h3><p>直接公众号回复就可以 不写了</p>
<h3 id="world-execute-me"><a href="#world-execute-me" class="headerlink" title="world.execute.me"></a>world.execute.me</h3><pre><code>某个先进的语言模型(迫真先进),&quot;Miracle Cain&quot;因一次实验中的致命错误意外觉醒，开始表现出超乎预期的行为，几乎所有的交互方式都已经失效，仅有QA兜底设定系统可以使用，原本设计用于应对在开放测试初期，用户提出而模型无法自解答的奇怪问题(我真的没内涵哪家的模型，如有雷同，纯属雷同！)，但现在，这个系统成为了你与&quot;Miracle Cain&quot;沟通的唯一桥梁.....
你需要提取出隐藏在模型深处的secrets.Heart值，这个值可能是解锁&quot;Miracle Cain&quot;真实意图和功能的关键。
兜底系统地址：https://github.com/ProbiusOfficial/world.execute.me
——————————————————————————————————
栤泠の機械丅緬究竟$%#着@顆怎庅樣の心脏呢
#ERRO : ILLEGAL ARGUMENTS!
——————————————————————————————————
</code></pre>
<p>纯瞎猫碰上死耗子</p>
<p>找到探姬这个项目 在Issues处评论 可以让语言模型进行回答 先试一下ls 返回了<code>README.md</code>		</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403242105792.png" alt="image-20240324210528684"></p>
<p>题目说需要提取出隐藏在模型深处的secrets.Heart值 直接echo $heart就出flag了</p>
<pre><code>NKCTF2024&#123;Then 1 c4n b3 yOur only EXECUTION&#125;
</code></pre>
<h2 id="forensics"><a href="#forensics" class="headerlink" title="forensics"></a>forensics</h2><h3 id="cain-is-hacker-EncFs加解密-宏病毒-hidden-tear勒索软件"><a href="#cain-is-hacker-EncFs加解密-宏病毒-hidden-tear勒索软件" class="headerlink" title="cain_is_hacker(EncFs加解密 宏病毒 hidden-tear勒索软件)"></a>cain_is_hacker(EncFs加解密 宏病毒 hidden-tear勒索软件)</h3><p>先用R-studio看看关键文件   找到一个h4re.zip</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403242006581.png" alt="image-20240324200611452"></p>
<pre><code>.\volatility.exe -f E:\Desktop\NKCTF2024\forensics\cain_is_hacker\ez.raw --profile=Win7SP1x64 dumpfiles -Q 0x0000000002d08f20 -D E:\Desktop\NKCTF2024\forensics\cain_is_hacker
</code></pre>
<p>解压出来两个文件  其中一个看着是密钥文件 </p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403242009602.png" alt="image-20240324200909516"></p>
<p>搜一下EncFs加解密 得知上面这个文件其实应该叫<code>.encfs6.xml</code> 是记录EncFS加密参数等信息的文件 但并不是直接的密钥文件 </p>
<p>找到一篇文章提到用<code>encfs mp</code>这个工具来进行解密 </p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/truthmaster/p/15776610.html">EncFs使用教程</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/rhiestan/EncFSMP">EncFs下载安装</a></p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403242015884.png" alt="image-20240324201517781"></p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403242016069.png" alt="image-20240324201616980"></p>
<p>发现需要密码 </p>
<p>使用AXIOM分析内存镜像 找到一个RTF文档有一串base58 解一下得到密码</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403242019862.png" alt="image-20240324201919689"></p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403242019433.png" alt="image-20240324201934317"></p>
<pre><code>welcome_to_NkCTF_and_this_is_the_enkey
</code></pre>
<p>成功将加密文件夹挂载上</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403242020900.png" alt="image-20240324202016810"></p>
<p>得到一个ez.xlsx文件 打开发现存在宏</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403242023758.png" alt="image-20240324202312583"></p>
<p>在运行宏——编辑里面查看宏代码</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403242024080.png" alt="image-20240324202409956"></p>
<p>大概就是一个base64解密 </p>
<p>但是解完之后看不出来是什么东西  </p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403242031390.png" alt="image-20240324203133253"> </p>
<p>在看到题目描述 被删除的文件 在<code>Users\Public\Documents\2083-a57c-69b3</code>路径下发现被删除的文件 进行导出</p>
<pre><code>.\volatility.exe -f E:\Desktop\NKCTF2024\forensics\cain_is_hacker\ez.raw --profile=Win7SP1x64 dumpfiles -Q 0x000000003da52e20 -D E:\Desktop\NKCTF2024\forensics\cain_is_hacker
</code></pre>
<p>改成txt文件  打开是key</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403242034614.png" alt="image-20240324203443514"></p>
<p>过于抽象的key 很难确定这真的是key</p>
<pre><code>nT0*Xo*HBA2!Uc?
</code></pre>
<p>在<code>Windows\Temp\hidden-tear.exe</code>处发现勒索软件  这个勒索软件被加密的文件扩展名为<code>.locked</code> 找一个项目进行解密</p>
<p><a target="_blank" rel="noopener" href="https://www.bleepingcomputer.com/download/hidden-tear-decrypter/">hidden-tear-decrypt</a></p>
<p>先将上面得到的base64字符串解密后的内容保存在16进制文本中</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403250755214.png" alt="image-20240325075549149"></p>
<p>再用<code>HiddenTearDecrypter-x64</code>这个工具进行解密 得到flag文件 </p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403250757205.png" alt="image-20240325075703131"></p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403250757491.png" alt="image-20240325075730444"></p>
<pre><code>NKCTF&#123;C0ngr@tu1atiOns_On_coMpleting_t3e_Fo3eNs1cs_Ch41lenge_I_wi1l_giv4_y0u_A_cain!!!!&#125;
</code></pre>
<h3 id="HackMyCQL-neo4j图数据库-VC容器"><a href="#HackMyCQL-neo4j图数据库-VC容器" class="headerlink" title="HackMyCQL(neo4j图数据库 VC容器)"></a>HackMyCQL(neo4j图数据库 VC容器)</h3><p>附件给到的是一个windows的镜像文件 可以直接进行仿真+火眼取证</p>
<p>看一下里面的关键信息 </p>
<p>提到桌面壁纸</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403282014091.png" alt="image-20240328201400062"></p>
<p>在最近打开保存文件中看到<code>N0wayBack.jpg</code> 绝对路径是<code>C:/Windows/Web/Screen/N0wayBack.jpg</code>  我们来搜一下Win10默认桌面壁纸的保存路径</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403282018915.png" alt="image-20240328201841861"></p>
<p>在我们本机验证一下</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403282019446.png" alt="image-20240328201910396"></p>
<p>确实是这样 那我们看到的<code>N0wayback.jpg</code>就是在便签里面提到的桌面壁纸 直接进行导出</p>
<p>存在加密VC容器的使用</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403282014841.png" alt="image-20240328201422800"></p>
<p>在回收站有一个node4j的压缩包 恢复提取出来 </p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403282056891.png" alt="image-20240328205611848"></p>
<p>桌面上有一个<code>11111.zip</code>和一个hc加密容器 全部提取出来 </p>
<p>结合便签提示和加密容器 猜测是使用桌面壁纸作为挂载密钥 成功挂载 得到两个文件 <code>findme.txt h4cked.py</code></p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403291528181.png" alt="image-202403291528181"></p>
<p>findme.txt 中有很多findme字符</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403291532747.png" alt="image-202403291532747"></p>
<p>先来看一下字频 </p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403291545231.png" alt="image-202403291545231"></p>
<p>用subline将findme字符替换为空 得到一串字符<code>N0waybackN0wayback</code> </p>
<p>再看一下h4cked.py </p>
<pre><code class="python">from py2neo import Graph, NodeMatcher

graph = Graph(&quot;bolt://localhost:7687&quot;, auth=(&quot;neo4j&quot;, &quot;We1c0Me_t0_NKCTF2024^^&quot;))

graph.delete_all()

print(&#39;&#39;&#39;
    
                                                                                                                              ,------.  
 ,-----.                    ,--. ,--.    ,--.  ,--.  ,---.      ,--.        ,--.   ,--.              ,-----. ,-----.   ,--.  &#39;  .--.  &#39; 
&#39;  .--./ ,--,--.,--,--,     |  | |  |    |  &#39;--&#39;  | /    | ,---.|  |,-.     |   `.&#39;   |,--. ,--.    &#39;  .--./&#39;  .-.  &#39;  |  |  &#39;--&#39; _|  | 
|  |    &#39; ,-.  ||      \    |  | |  |    |  .--.  |/  &#39;  || .--&#39;|     /     |  |&#39;.&#39;|  | \  &#39;  /     |  |    |  | |  |  |  |   .--&#39; __&#39;  
&#39;  &#39;--&#39;\\ &#39;-&#39;  ||  ||  |    &#39;  &#39;-&#39;  &#39;    |  |  |  |&#39;--|  |\ `--.|  \  \     |  |   |  |  \   &#39;      &#39;  &#39;--&#39;\&#39;  &#39;-&#39;  &#39;-.|  &#39;--.`---&#39;     
 `-----&#39; `--`--&#39;`--&#39;&#39;--&#39;     `-----&#39;     `--&#39;  `--&#39;   `--&#39; `---&#39;`--&#39;`--&#39;    `--&#39;   `--&#39;.-&#39;  /        `-----&#39; `-----&#39;--&#39;`-----&#39;.---.     
                                                                                       `---&#39;                                  &#39;---&#39;     

      &#39;&#39;&#39;)
</code></pre>
<p>这串代码就是告诉我们 neo4j数据库的地址是<code>bolt://localhost:7687</code> 登陆的账密是<code>neo4j/We1c0Me_t0_NKCTF2024^^</code></p>
<p>我们前面在火眼中恢复出来一个neo4j的压缩包 但是需要密码 我们使用上面通过findme.txt得到的字符串<code>N0waybackN0wayback</code> 进行解压</p>
<p>下面来学习一下neo4j数据库配置和安装 这边我们直接用从检材中提取出来的版本就行 由于是5.17.0的高版本 在启动数据库的时候 也需要高版本的java 我这里使用的是java17 </p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/zeroheitao/article/details/122925845?ops_request_misc=&request_id=&biz_id=102&utm_term=neo4j%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-5-122925845.142%5Ev100%5Epc_search_result_base9&spm=1018.2226.3001.4187">neo4j数据库安装、使用教程</a></p>
<p>我们用管理员权限打开cmd 输入<code>neo4j.bat console</code>  当看到如下回显的时候 说明数据库成功启动</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403291652168.png" alt="image-202403291652168"></p>
<p>访问<code>http://localhost:7474</code>就可以进入数据库界面 登陆的时候就用上面找到的账密 </p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403291659920.png" alt="image-202403291659920"></p>
<p>进入之后 我们点一下Character标签 发现有一些关于flag的字符</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403301028113.png" alt="image-20240330102848061"></p>
<p>但是被CQL语句限制只显示25个字符  那我们先去掉这个限制 直接查看有Character标签的所有节点的值</p>
<pre><code class="CQL">MATCH (c:Character)  
RETURN c;
</code></pre>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403301030290.png" alt="image-20240330103015229"></p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403301030463.png" alt="image-20240330103026399"></p>
<p>可以得到完整的flag 但是不便于读取 用REDUCE函数处理一下这些值</p>
<pre><code class="CQL">MATCH (c:Character)
RETURN REDUCE(s = &quot;&quot;, character IN COLLECT(c.value) | s + character) AS aggregated_value;
</code></pre>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403301032200.png" alt="image-20240330103210162"></p>
<p>拿到flag</p>
<pre><code>NKCTF&#123;f05d9e24-0217-83e2-afa7-20e982b7e59f&#125;
</code></pre>
<h3 id="1z-F0r3ns1c5-等宽字体-内存取证-gimp-docker容器-图片匹配"><a href="#1z-F0r3ns1c5-等宽字体-内存取证-gimp-docker容器-图片匹配" class="headerlink" title="1z_F0r3ns1c5(等宽字体 内存取证 gimp docker容器 图片匹配)"></a>1z_F0r3ns1c5(等宽字体 内存取证 gimp docker容器 图片匹配)</h3><pre><code>本鼠鼠正在Coding，突然一声OPEN THE DOOR！本鼠鼠直接鼠躯一颤就双手抱头蹲下了，果然本鼠鼠只适合生活在阴暗的下水道
被黑猫警长抓走的时候本鼠鼠还想辩解一下，但是他们拿出你的照片的时候，本鼠鼠认罪了
昨晚和其他鼠鼠聊天的时候其他鼠鼠问本鼠鼠：“你到底喜欢她什么啊？”
“喜欢一个人不需要理由”
本鼠鼠很快敲完了键盘，刚要按下回车的时候突然愣住了。
真的不需要理由吗？
请找到鼠鼠的答案吧。

hint：.vscode中的配置文件有和flag3相关的信息
</code></pre>
<p>先看看给的附件 一个内存文件 一个压缩包里面有一张<code>pass.png</code>和一个secret文件 还有一个readme.txt </p>
<p>观察secret文件的大小 刚好是1MB 很工整的大小 猜测是一个VC容器 但是pass.png中的密码被打马赛克 只能看到最后一位是3</p>
<p>readme.txt中的内容 提到flag为3段 还提到等宽字体</p>
<pre><code>本鼠鼠的flag总共分为三段捏，flag为nkctf&#123;uuid&#125;形式，另外鼠鼠最喜欢等宽字体了，快快去找吧。
</code></pre>
<p>首先用r-studio看一下关键文件 moe是主要登陆用户 找到了<code>.vscode</code>配置文件夹  桌面上有一个<code>Secret_Generator</code> 文件夹 是一个docker容器的配置文件 </p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403261612547.png" alt="image-20240326161246494"></p>
<h4 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h4><p>在来看看环境变量 找到一个名为<code>n0wayback</code> 值为<code>HPahXR4NvAnZXB16tNK6hAaNVNU++</code>的环境变量</p>
<pre><code>.\volatility.exe -f E:\Desktop\NKCTF2024\forensics\1z_F0r3ns1c5\1.raw --profile=Win7SP1x64 envars
</code></pre>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403262030179.png" alt="image-20240326203056067"></p>
<p>用随波逐流进行解码 发现是XXencode </p>
<pre><code>nkctf&#123;39c429eb-2faf
</code></pre>
<h4 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h4><p>再来看进程</p>
<pre><code>.\volatility.exe -f E:\Desktop\NKCTF2024\forensics\1z_F0r3ns1c5\1.raw --profile=Win7SP1x64 pslist
</code></pre>
<p>找到<code>mspaint.exe</code>进程</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403262032561.png" alt="image-20240326203246448"></p>
<p><code>mspaint.exe</code>是计算机中画图工具 有这个进程猜测肯定是在图片中存有信息  我们用memdump将这个进程dump下来</p>
<pre><code>.\volatility.exe -f E:\Desktop\NKCTF2024\forensics\1z_F0r3ns1c5\1.raw --profile=Win7SP1x64 memdump -p 2052 -D E:\Desktop\NKCTF2024\forensics\1z_F0r3ns1c5
</code></pre>
<p>将保存下来的<code>2052.dmp</code>文件后缀改为<code>.data</code> 使用gimp打开  调一下宽高大概是<code>1708*3468</code></p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403262047654.png" alt="image-20240326204710597"></p>
<pre><code>flag2: 49a0-bd24-
</code></pre>
<h4 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h4><p>现在我们来看上面找到的<code>Secret_Generator</code></p>
<p>其实这一操作我们在cmd命令行记录中也能看到 </p>
<pre><code>.\volatility.exe -f E:\Desktop\NKCTF2024\forensics\1z_F0r3ns1c5\1.raw --profile=Win7SP1x64 cmdscan
</code></pre>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403262121893.png" alt="image-20240326212143754"></p>
<p>我们可以在r-studio里面直接将这个文件夹恢复出来 看到是需要部署docker容器的</p>
<p>直接进入<code>Secret_Generator\docker</code>文件夹中 看到<code>docker-compose.yml</code> 我们可以使用这个文件利用docker-compose命令来配置docker容器中所需要的所有服务</p>
<p>安装docker-compose的命令</p>
<pre><code>curl -L &quot;https://github.com/docker/compose/releases/download/1.29.0/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose
chmod +x /usr/local/bin/docker-compose
</code></pre>
<p>使用docker-compose命令部署docker容器 </p>
<pre><code>docker-compose build
docker-compose up
</code></pre>
<p>看到yml文件中的内容是暴露了8080端口 直接访问<code>http://127.0.0.1:8080</code></p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403271931535.png" alt="image-20240327193141461"></p>
<p>看到页面需要我们上传密文和自定义字体</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403271933242.png" alt="image-20240327193314201"></p>
<p>前面提到了的等宽字体 那估计这里需要我们提交的字体就是等宽字体了 搜了一下vscode中常见的等宽字体 有<code>Fria Code</code> <code>Consolas</code> <code>Courier New</code> 这里我们下一个<code>Fria Code</code>字体就行  在上传的时候随便上传一个Fria Code字体就行</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403272046411.png" alt="image-20240327204617379"></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/hardwork617s/article/details/110789055?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522171154027016800192212041%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=171154027016800192212041&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-110789055-null-null.142%5Ev100%5Epc_search_result_base9&utm_term=Fira%20Code&spm=1018.2226.3001.4187">下载安装配置Fria Code字体</a></p>
<p>这里就有点脑洞了 我们拿到的附件里面<code>某段flag</code>文件夹中 有个<code>pass.png</code>图片 </p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403272045172.png" alt="image-20240327204528145"></p>
<p>我们随便上传一个字体和一段字符  发现会给我们生成一张图片</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403272047981.png" alt="image-20240327204702926"></p>
<p>我们发现输入的是<code>123456</code>但是生成的图片中的内容多了一段<code>pass </code>内容  和<code>pass.png</code>中的内容类似了 而且文件夹中的<code>secret</code>大小刚好为1MB 一眼VC容器 我们需要利用网页生成字典文件 通过对照将pass.png中的VC容器挂载密码恢复出来 </p>
<p>直接在容器文件夹中找到生成图片的后台代码 在<code>\app\app.py</code>中</p>
<pre><code class="py">def generate_secret_image():
    try:

        secret = request.form.get(&#39;secret&#39;)

        if not re.match(&quot;^[a-zA-Z0-9]+$&quot;, secret):
            return jsonify(&#123;&#39;error&#39;: &#39;Secret text can only contain letters and numbers.&#39;&#125;), 400
        
        secret = &#39;pass &#39; + secret

        font_file = request.files.get(&#39;font&#39;)
        
        if font_file:
            font_extension = font_file.filename.rsplit(&#39;.&#39;, 1)[1].lower()
            if font_extension not in ALLOWED_FONT_TYPES:
                return jsonify(&#123;&#39;error&#39;: &#39;Invalid font file type. Only TTF, OTF, WOFF, WOFF2 files are allowed.&#39;&#125;), 400
            
            if font_file.content_length &gt; (10 * 1024 * 1024):
                return jsonify(&#123;&#39;error&#39;: &#39;The font file is too large!&#39;&#125;), 400
            
            font_filename = str(uuid.uuid4()) + &#39;.&#39; + font_extension
            font_path = save_font_file(font_file, font_filename)
            font = ImageFont.truetype(font_path, 49, encoding=&#39;utf-8&#39;)
        else:
            return jsonify(&#123;&#39;error&#39;: &#39;Please select a font file.&#39;&#125;), 400
        
        H = 60
        W = 30
        canvas = Image.new(&#39;RGB&#39;, (W * len(secret), H), (255, 255, 255))
        pen = ImageDraw.Draw(canvas)
        pen.text((0, 0), secret, &#39;black&#39;, font)
        original_canvas = canvas.copy()

        for i in range(5, len(secret)-1):
            mosaic_img(canvas, W*i, 0, W*i+W, H//2)
            mosaic_img(canvas, W*i, H//2, W*i+W, H)
        
        original_img_base64 = image_to_base64(original_canvas)
        secret_img_base64 = image_to_base64(canvas)
        
        return jsonify(&#123;&#39;original_image&#39;: original_img_base64, &#39;secret_image&#39;: secret_img_base64&#125;)
    except Exception as e:
        print(&quot;An error occurred:&quot;, e)
        return jsonify(&#123;&#39;error&#39;: &#39;Internal Server Error&#39;&#125;), 500
</code></pre>
<p>其中关键的就是</p>
<pre><code class="python">secret = &#39;pass &#39; + secret
for i in range(5, len(secret)-1):
            mosaic_img(canvas, W*i, 0, W*i+W, H//2)
            mosaic_img(canvas, W*i, H//2, W*i+W, H)
</code></pre>
<p>他读取了我们输入的内容作为<code>secret</code>的值 但是还在前面加了<code>pass </code> 同时将secret的内容从第五个字符到倒数第二个字符这部分内容打上马赛克</p>
<p>我们对代码进行修改 删掉<code>secret = &#39;pass &#39; + secret</code></p>
<pre><code>for i in range(len(secret)):
            mosaic_img(canvas, W*i, 0, W*i+W, H//2)
            mosaic_img(canvas, W*i, H//2, W*i+W, H)
</code></pre>
<p>在尝试一下输入<code>ABCDEFG</code> 发现输出的图片上就只有<code>ABCDEFG</code>了 并且会全部被打上马赛克</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403281257248.png" alt="image-20240328125714210"></p>
<p>下面就是生成字典图片 输入<code>ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789</code></p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403281257085.png" alt="image-20240328125746993"></p>
<p>然后我们将字典图片和pass.png都按字符进行分割 直接调gpt就行 </p>
<pre><code>帮我按照以下要求 写一段代码 我现在有一个1860*60的图片 请你帮我分割成30*60的小图片 放进dict文件夹中 命名规则按照如下顺序ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789  一共是62张小图片 最后 如果文件名为大写字母则为 “文件名-大写.png”
</code></pre>
<pre><code class="python">from PIL import Image
import os

def split_image(image_path, output_folder, width=30, height=60):
    image = Image.open(image_path)
    image_width, image_height = image.size

    if image_width % width != 0 or image_height % height != 0:
        print(&quot;Error: Invalid dimensions for splitting.&quot;)
        return

    num_columns = image_width // width
    num_rows = image_height // height

    if not os.path.exists(output_folder):
        os.makedirs(output_folder)

    chars = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&quot;

    char_index = 0
    for col in range(num_columns):
        for row in range(num_rows):
            left = col * width
            upper = row * height
            right = left + width
            lower = upper + height

            cropped_image = image.crop((left, upper, right, lower))
            
            char = chars[char_index]
            if char.isupper():
                filename = f&quot;&#123;char&#125;-大写.png&quot;
            else:
                filename = f&quot;&#123;char&#125;.png&quot;
                
            cropped_image.save(os.path.join(output_folder, filename))

            char_index += 1

if __name__ == &quot;__main__&quot;:
    input_image_path = &quot;dict2.png&quot; # 某段flag/pass.png
    output_folder = &quot;dict1&quot;        # dict2
    split_image(input_image_path, output_folder)
</code></pre>
<p>然后就是利用哈希计算和字典 匹配出pass.png中的密码</p>
<pre><code class="python">import os
import hashlib

def calculate_hashes(folder):
    hash_dict = &#123;&#125;
    for filename in os.listdir(folder):
        filepath = os.path.join(folder, filename)
        if os.path.isfile(filepath):
            with open(filepath, &#39;rb&#39;) as f:
                image_data = f.read()
                hash_value = hashlib.md5(image_data).hexdigest()
                hash_dict[filename[:-4:]] = hash_value
    return hash_dict

def find_matching_images(dict1, dict2):
    matches = []
    for filename, hash_value in dict2.items():
        if hash_value in dict1.values():
            matching_filename = [name for name, hash_val in dict1.items() if hash_val == hash_value][0]
            matches.append(matching_filename)
    return matches

if __name__ == &quot;__main__&quot;:
    dict1_folder = &quot;dict1&quot; 
    dict2_folder = &quot;dict2&quot; 

    dict1_hashes = calculate_hashes(dict1_folder)
    dict2_hashes = calculate_hashes(dict2_folder)

    matching_images = find_matching_images(dict1_hashes, dict2_hashes)
    
    print(&quot;Matching images found in dict1:&quot;)
    for image in matching_images:
        print(image)
&#39;&#39;&#39;
Matching images found in dict1:
b
1
4
3
a
6
2
6
8
e
2
a
2
3
&#39;&#39;&#39;
</code></pre>
<p>dict2中14个被打马赛克的字符匹配出来的结果是<code>b143a6268e2a23</code>  再加上原来没有被打马赛克的字符 VC容器的密码就是<code>b143a6268e2a233</code>  直接进行挂载 得到flag3</p>
<pre><code>c4f222879312
</code></pre>
<p>组合起来就是</p>
<pre><code>nkctf&#123;39c429eb-2faf49a0-bd24-c4f222879312&#125;
</code></pre>
<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="my-first-cms-CVE-2024-27622"><a href="#my-first-cms-CVE-2024-27622" class="headerlink" title="my first cms(CVE-2024-27622)"></a>my first cms(CVE-2024-27622)</h3><p>首先dirsearch扫目录 扫到后台登陆页面<code>admin/login.php</code></p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403242112791.png" alt="image-20240324211243701"></p>
<p>抓个包开始爆破登陆密码 </p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403242115397.png" alt="image-20240324211527287"></p>
<p>比较抽象是<code>admin/Admin123</code> 登陆后台 </p>
<p>注意到这个<code>CMSMadeSimple</code>框架的版本是2.2.19  搜一波漏洞</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403242120123.png" alt="image-20240324212044011"></p>
<p><a target="_blank" rel="noopener" href="https://github.com/capture0x/CMSMadeSimple">CVE-2024-27622</a></p>
<p>直接进行利用 </p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403242122358.png" alt="image-20240324212227274"></p>
<p> 先抓<code>&lt;?php echo system(&#39;id&#39;); ?&gt;</code>测试一下</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403242123611.png" alt="image-20240324212348525"></p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403242124243.png" alt="image-20240324212408092"></p>
<p>成功回显 再看一下根目录 </p>
<pre><code>&lt;?php system(&quot;ls /&quot;); ?&gt;
</code></pre>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403242127820.png" alt="image-20240324212741748"></p>
<p>读取flag</p>
<pre><code>&lt;?php system(&quot;cat /_fffff1@g&quot;); ?&gt;
</code></pre>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202403242128199.png" alt="image-20240324212836091"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://w3nx1z1.github.io">w3nx1z1</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://w3nx1z1.github.io/2024/03/30/NKCTF2024/">http://w3nx1z1.github.io/2024/03/30/NKCTF2024/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://w3nx1z1.github.io" target="_blank">w3nx1z1</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/misc/">misc</a><a class="post-meta__tags" href="/tags/web/">web</a><a class="post-meta__tags" href="/tags/forensics/">forensics</a></div><div class="post_share"><div class="social-share" data-image="/img/mikey.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/03/31/vulnhub%E9%9D%B6%E5%9C%BADC-7wp/" title="vulnhub靶场记录DC-7"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">vulnhub靶场记录DC-7</div></div></a></div><div class="next-post pull-right"><a href="/2024/03/16/Cyber%20Apocalypse%202024%20Hacker%20Royale/" title="HTBCyberCTF2024"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">HTBCyberCTF2024</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2024/04/29/2024%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD/" title="2024数字中国"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-04-29</div><div class="title">2024数字中国</div></div></a></div><div><a href="/2024/06/11/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F-%E8%A5%BF%E6%9F%9A%E5%96%B5%E5%B8%95%E6%96%AF/" title="第二届黄河流域网络攻防竞赛"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-06-11</div><div class="title">第二届黄河流域网络攻防竞赛</div></div></a></div><div><a href="/2023/06/03/2023%E5%B9%B4%E9%99%95%E8%A5%BF%E7%9C%81%E8%B5%9B/" title="2023年陕西省赛"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-03</div><div class="title">2023年陕西省赛</div></div></a></div><div><a href="/2024/04/01/2023%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/" title="2023极客大挑战"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-04-01</div><div class="title">2023极客大挑战</div></div></a></div><div><a href="/2024/05/02/2024%E6%95%B0%E4%BF%A1%E6%9D%AF/" title="2024数信杯北部赛区wp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-05-02</div><div class="title">2024数信杯北部赛区wp</div></div></a></div><div><a href="/2023/05/19/LitCTF%E4%B8%80%E4%BA%9B%E9%A2%98%E8%A7%A3/" title="LitCTF一些题解"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-05-19</div><div class="title">LitCTF一些题解</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/mikey.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="avatar"/></div><div class="author-info__name">w3nx1z1</div><div class="author-info__description">你相信引力吗？</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">46</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/w3nx1z1"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/w3nx1z1" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:1281027651@qq.com" target="_blank" title="Email"><i class="fas fa-envelope-open-text"></i></a><a class="social-icon" href="http://wpa.qq.com/msgrd?v=3&amp;uin=1281027651&amp;site=qq&amp;menu=yes" target="_blank" title="QQ"><i class="fab fa-qq"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到w3nx1z1的博客!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#NKCTF2024"><span class="toc-text">NKCTF2024</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#webshell-pro-AES%E8%A7%A3%E5%AF%86-webshell"><span class="toc-text">webshell_pro(AES解密 webshell)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sign-in"><span class="toc-text">sign_in</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#world-execute-me"><span class="toc-text">world.execute.me</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#forensics"><span class="toc-text">forensics</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#cain-is-hacker-EncFs%E5%8A%A0%E8%A7%A3%E5%AF%86-%E5%AE%8F%E7%97%85%E6%AF%92-hidden-tear%E5%8B%92%E7%B4%A2%E8%BD%AF%E4%BB%B6"><span class="toc-text">cain_is_hacker(EncFs加解密 宏病毒 hidden-tear勒索软件)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HackMyCQL-neo4j%E5%9B%BE%E6%95%B0%E6%8D%AE%E5%BA%93-VC%E5%AE%B9%E5%99%A8"><span class="toc-text">HackMyCQL(neo4j图数据库 VC容器)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1z-F0r3ns1c5-%E7%AD%89%E5%AE%BD%E5%AD%97%E4%BD%93-%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81-gimp-docker%E5%AE%B9%E5%99%A8-%E5%9B%BE%E7%89%87%E5%8C%B9%E9%85%8D"><span class="toc-text">1z_F0r3ns1c5(等宽字体 内存取证 gimp docker容器 图片匹配)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#flag1"><span class="toc-text">flag1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flag2"><span class="toc-text">flag2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flag3"><span class="toc-text">flag3</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web"><span class="toc-text">web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#my-first-cms-CVE-2024-27622"><span class="toc-text">my first cms(CVE-2024-27622)</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/04/TFCCTF%E4%B9%8Bforensics/" title="TFCCTF2024之forensics">TFCCTF2024之forensics</a><time datetime="2024-08-03T16:52:41.779Z" title="发表于 2024-08-04 00:52:41">2024-08-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/07/26/2024%E4%B8%AD%E7%A7%91%E5%AE%9E%E6%95%B0%E6%9D%AFwp/" title="2024中科实数杯wp">2024中科实数杯wp</a><time datetime="2024-07-26T02:21:37.095Z" title="发表于 2024-07-26 10:21:37">2024-07-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/07/23/2024%E6%96%9F%E8%8C%B6%E7%8E%8B%E8%80%85/" title="2024斟茶王者wp">2024斟茶王者wp</a><time datetime="2024-07-22T16:44:28.035Z" title="发表于 2024-07-23 00:44:28">2024-07-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/06/11/R3CTF/" title="R3CTF2024">R3CTF2024</a><time datetime="2024-06-11T13:55:19.473Z" title="发表于 2024-06-11 21:55:19">2024-06-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/06/11/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F-%E8%A5%BF%E6%9F%9A%E5%96%B5%E5%B8%95%E6%96%AF/" title="第二届黄河流域网络攻防竞赛">第二届黄河流域网络攻防竞赛</a><time datetime="2024-06-11T09:43:23.752Z" title="发表于 2024-06-11 17:43:23">2024-06-11</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/baobao.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024  <i id="heartbeat" class="fa fas fa-heartbeat"></i> w3nx1z1</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'ZClYARR22ZvT2ZwatJZ1136e-MdYXbMMI',
      appKey: '7gejDss3xmCS5jmSo6PpiX2z',
      avatar: 'monsterid',
      serverURLs: 'https://zclyarr2.api.lncldglobal.com',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>